# ［C++］WG21月次提案文書を眺める（2022年09月）

文書の一覧

- [JTC1/SC22/WG21 - Papers 2022 mailing2022-09](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/#mailing2022-09)

全部で29本あります。

[:contents]

### [N4917 Working Draft, Standard for Programming Language C++](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/n4917.pdf)

C++23のワーキングドラフト第7弾。

### [N4918 Editors’ Report - Programming Languages – C++](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/n4918.html)

↑の変更点をまとめた文書。

7月の会議で採択された提案とコア言語/ライブラリのIssue解決が適用されています。

### [N4919 Programming Languages - C++](https://www.open-std.org/jtc1/sc22/wg21/prot/14882fdis/n4919.pdf)

これは何かよく分かりません。

### [N4920 Working Draft, C++ Extensions for Library Fundamentals, Version 3](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/n4920.html)

次期標準ライブラリ機能候補の実装経験を得るためのTSである、Library Fundamental TS v3の文書。

### [N4921 Editor’s Report: C++ Extensions for Library Fundamentals, Version 3](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/n4921.html)

↑の変更点を記した文書。

この版での変更は、typoの修正などです。

### [N4922 INCITS C++/WG21 agenda: 7-12 November 2022, Kona, HI US](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/n4922.html)

11月に行われる予定の、WG21全体会議のアジェンダ。

### [P0543R2 Saturation arithmetic](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p0543r2.html)
### [P0792R11 function_ref: a non-owning reference to a Callable](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p0792r11.html)
### [P0957R9 Proxy: A Polymorphic Programming Library](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p0957r9.pdf)
### [P0987R1 `polymorphic_allocator` instead of type-erasure](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p0987r1.pdf)

`std::function`に`std::pmr::polymorphic_allocator`によるアロケータサポートを追加する提案。

`std::function`のアロケータサポートはそれが実装されなかったことからC++14で削除されており、現在の`std::function`はアロケータのカスタマイズができなくなっています。一方、Library Fundamental TS v3にある`std::experimental::function`にはアロケータを受け取るコンストラクタとアロケータを型消去して保持するためのユーティリティが存在しています。

この提案は、そのLFTSv3にある`std::experimental::function`のアロケータサポートを専用の型消去アロケータではなくC++20で導入された`std::pmr::polymorphic_allocator<>`で置き換えるものです。


現在のLFTSv3にある`std::experimental::function`のコンストラクタは次のようになっています。

```cpp
template<class F, class A> 
function(allocator_arg_t, const A&, F);
```

ここの`F, A`の2つのパラメータはクラステンプレートには現れていません。ここでは2つの型の型消去が必要となり実装が複雑になります。また、現在のLFTSv3にある型消去アロケータはそれを受け取る他のオブジェクト（ここでは`std::experimental::function`）の領域内にうまく配置（スペースの節約）することができるようにより複雑になっています。

この提案はこれを次のように置き換えます

```cpp
template<class F> 
function(allocator_arg_t, const pmr::polymorphic_allocator<>&, F);
```

また同時に、現在使用しているアロケータを取得するためのインターフェースも追加します。

```cpp
polymorphic_allocator<> get_allocator() const noexcept;
```

`std::pmr::polymorphic_allocator<>`を用いることでアロケータの型消去と複雑な型消去アロケータが不用になり実装が簡単になります。また、この提案ではこの`std::pmr::polymorphic_allocator<>`の保持方法を特に指定しないため、単にメンバとして保持するのではなく型消去のための領域に保持するなどの効率化が図れます。

- [P0987 進行状況](https://github.com/cplusplus/papers/issues/1299)

### [P1030R5 std::filesystem::path_view](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1030r5.pdf)
### [P1985R3 Universal template parameters](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1985r3.pdf)
### [P2348R3 Whitespaces Wording Revamp](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2348r3.pdf)
### [P2495R1 Interfacing stringstreams with string_view](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2495r1.pdf)
### [P2586R0 Standard Secure Networking](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2586r0.pdf)
### [P2587R3 to_string or not to_string](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2587r3.html)
### [P2588R1 Relax std::barrier phase completion step guarantees](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2588r1.html)
### [P2603R1 member function pointer to function pointer](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2603r1.html)
### [P2620R2 Improve the wording for Universal Character Names in identifiers](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2620r2.pdf)
### [P2623R2 implicit constant initialization](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2623r2.html)
### [P2631R0 Publish TS Library Fundamentals v3 Now!](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2631r0.html)
### [P2636R0 References to ranges should always be viewable](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2636r0.html)
### [P2637R0 Member visit and apply](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2637r0.html)
### [P2638R0 Intel's response to P1915R0 for std::simd parallelism in TS 2](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2638r0.pdf)
### [P2639R0 Static Allocations](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2639r0.pdf)
### [P2640R0 Modules: Inner-scope Namespace Entities: Exported or Not?](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2640r0.pdf)
### [P2641R0 Checking if a union alternative is active](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2641r0.html)
### [P2642R0 Padded mdspan layouts](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2642r0.html)
### [P2643R0 Improving C++ concurrency features](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2643r0.html)
